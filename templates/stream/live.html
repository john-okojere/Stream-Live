{% extends "base.html" %}
{% load static %}

{% block title %}Layers of Truth | Live Service Audio Stream{% endblock %}
{% block meta %}
<meta name="title" content="Layers of Truth | Live Service Audio Stream" />
<meta name="description" content="Join the Layers of Truth live service audio stream. Listen live, worship with us, and experience God's presence wherever you are." />
<link rel="canonical" href="https://stream.layersoftruth.org/live" />

<!-- Open Graph / Twitter -->
<meta property="og:type" content="website" />
<meta property="og:url" content="https://stream.layersoftruth.org/live" />
<meta property="og:title" content="Layers of Truth | Live Service Audio Stream" />
<meta property="og:description" content="Join the Layers of Truth live service audio stream. Listen live, worship with us, and experience God's presence wherever you are." />
<meta property="og:image" content="https://layersoftruth.org/assets/gatherings-flyer.png" />
<meta property="og:image:width" content="1200" />
<meta property="og:image:height" content="630" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://layersoftruth.org/assets/gatherings-flyer.png" />
<meta name="twitter:site" content="@Layers_of_Truth" />
{% endblock meta %}

{% block head %}
<style>
  .live-hero{
    background:
      radial-gradient(140% 140% at -10% -20%, rgba(123,140,255,.22), transparent 52%),
      radial-gradient(120% 120% at 120% -10%, rgba(210,72,255,.16), transparent 54%),
      linear-gradient(135deg, rgba(15,22,40,.95), rgba(10,16,28,.92));
  }
  .live-hero::after{
    content:""; position:absolute; inset:0;
    background: radial-gradient(320px 320px at 80% 30%, rgba(255,255,255,.05), transparent 60%);
    opacity:.8; pointer-events:none;
  }
  .hero-badges{ display:flex; flex-wrap:wrap; gap:.5rem; margin:.5rem 0 0 0; }

  .live-stage{ position:relative; overflow:hidden; }
  .live-stage::after{
    content:""; position:absolute; inset:0;
    background:radial-gradient(80% 60% at 0% 0%, rgba(123,140,255,.08), transparent 60%);
    pointer-events:none;
  }
  .live-stage .player-stage{
    border:1px solid var(--ring);
    border-radius:14px;
    background: linear-gradient(180deg, rgba(255,255,255,.04), rgba(255,255,255,.02));
    min-height: 320px;
    display:flex; align-items:center; justify-content:center;
    overflow:hidden;
  }
  #rcPlayer, #rcPlayer > *, #rcPlayer iframe{
    width:100% !important; height:100% !important; border:0 !important;
  }

  .list-check{ list-style:none; padding:0; margin:0; display:grid; gap:.75rem; }
  .list-check li{ display:grid; grid-template-columns:auto 1fr; gap:.65rem; align-items:flex-start; }
  .list-check .bi{ color: var(--accent); }

  .social-links{ display:flex; flex-wrap:wrap; gap:.5rem; }
  .social-links a{
    display:inline-flex; align-items:center; gap:.5rem;
    padding:.55rem .9rem; border-radius:12px;
    text-decoration:none; color:#fff; font-weight:700;
    border:1px solid rgba(255,255,255,.12);
    background: rgba(255,255,255,.05);
    transition: transform .15s ease, box-shadow .15s ease;
  }
  .social-links a:hover{ transform: translateY(-2px); box-shadow:0 12px 26px rgba(0,0,0,.35); }

  .gallery-lt{ display:grid; gap:12px; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); }
  .gallery-lt figure{
    position:relative; border-radius:14px; overflow:hidden; margin:0;
    background: linear-gradient(135deg,#12192f,#0c1222);
    cursor:zoom-in;
  }
  .gallery-lt img{ width:100%; height:100%; object-fit:cover; display:block; transition: transform .35s ease; }
  .gallery-lt figure:hover img{ transform: scale(1.05); }

  .lightbox{ position:fixed; inset:0; background:rgba(0,0,0,.75); display:none; place-items:center; z-index:1200; }
  .lightbox.open{ display:grid; animation:fade .25s ease both; }
  .lightbox img{ max-width:92vw; max-height:85vh; border-radius:12px; box-shadow:0 20px 50px rgba(0,0,0,.6); }
  @keyframes fade{ from{opacity:0} to{opacity:1} }

  .mini-cta{
    position:fixed; inset:auto 0 calc(var(--player-h) + 12px) 0;
    z-index:1035; padding:0 12px;
    display:flex; justify-content:center; pointer-events:none;
  }
  .mini-shell{
    width:min(100%, 1024px);
    display:flex; align-items:center; justify-content:space-between; gap:1rem;
    padding:.75rem 1rem; border-radius:14px;
    background: rgba(11,18,34,.92);
    border:1px solid rgba(255,255,255,.12);
    backdrop-filter: saturate(140%) blur(10px);
    transform: translateY(120%); opacity:0; transition: transform .35s ease, opacity .35s ease;
    pointer-events:auto;
  }
  .mini-shell.show{ transform:none; opacity:1; }
  .mini-shell img{ width:42px; height:42px; border-radius:10px; object-fit:cover; border:1px solid rgba(255,255,255,.14); }

  @media (max-width: 767.98px){
    .live-stage .player-stage{ min-height:240px; }
    .mini-shell{ align-items:flex-start; flex-direction:column; }
  }
</style>
{% endblock head %}

{% block content %}
<section class="container section-gap">
  <div class="page-hero live-hero">
    <div class="row g-4 align-items-center">
      <div class="col-lg-7">
        <span class="eyebrow"><i class="bi bi-broadcast-pin"></i> Live Service</span>
        <h1 class="mb-2">Stream Layers of Truth live</h1>
        <p class="lede">Join worship, prayer, and teaching wherever you are. The stream is audio-first so it stays smooth on low bandwidth while the global player keeps playing as you browse.</p>
        <div class="hero-badges">
          <span class="chip"><i class="bi bi-clock-history"></i> Sundays · 10:00 AM WAT</span>
          <span class="chip"><i class="bi bi-wifi"></i> Auto-connect when we go live</span>
          <span class="chip"><i class="bi bi-geo-alt"></i> Lagos, NG</span>
        </div>
        <div class="hero-actions">
          <button class="btn btn-brand" type="button" data-bs-toggle="offcanvas" data-bs-target="#liveDrawer">
            <i class="bi bi-broadcast-pin"></i> Open live player
          </button>
          <a class="btn btn-outline-light" href="{% url 'stream:past_list' %}"><i class="bi bi-journal-music"></i> Past streams</a>
          <button class="btn btn-soft" type="button" data-share><i class="bi bi-share"></i> Share</button>
        </div>
      </div>
      <div class="col-lg-5">
        <div class="glass-card p-3 p-md-4 h-100">
          <div class="d-flex align-items-center gap-3">
            <img src="{% static 'assets/gatherings-flyer.png' %}" alt="Layers of Truth flyer" style="width:82px;height:82px;object-fit:cover;border-radius:14px;border:1px solid rgba(255,255,255,.14);">
            <div>
              <div class="micro-badge"><i class="bi bi-broadcast"></i> Streaming now</div>
              <div class="fw-bold h5 mb-1">Live Service Audio</div>
              <p class="text-muted m-0 small">Player stays at the bottom so you can keep exploring.</p>
            </div>
          </div>
          <div class="d-flex flex-wrap gap-2 mt-3">
            <a class="btn btn-primary" href="#playerStage"><i class="bi bi-broadcast-pin"></i> Jump to player</a>
            <a class="btn btn-outline-light" href="{% static 'assets/gatherings-flyer.png' %}" target="_blank" rel="noopener"><i class="bi bi-image"></i> View artwork</a>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="container section-gap">
  <div class="row g-4 align-items-start">
    <div class="col-lg-7">
      <div class="glass-card p-3 p-md-4 live-stage" id="playerStage">
        <div class="d-flex align-items-center justify-content-between flex-wrap gap-2 mb-3">
          <div class="d-flex flex-wrap gap-2">
            <span class="chip"><i class="bi bi-broadcast-pin"></i> Live channel</span>
            <span class="chip"><i class="bi bi-volume-up"></i> Low-latency audio</span>
          </div>
          <button class="btn btn-outline-light btn-sm" type="button" data-bs-toggle="offcanvas" data-bs-target="#queueDrawer">
            <i class="bi bi-music-note-list"></i> Up next
          </button>
        </div>
        <div class="player-stage" id="livePlayerHost">
          <div id="rcPlayer"></div>
        </div>
        <small class="text-muted d-block mt-2">The player will connect automatically when we go live.</small>
      </div>

      <div class="glass-card p-3 p-md-4 section-gap">
        <h6 class="mb-2">Quick start</h6>
        <ol class="list-check">
          <li><i class="bi bi-check-circle-fill"></i><div><strong>Open the live player.</strong> Tap the purple Live button in the nav or hit “Open live player”.</div></li>
          <li><i class="bi bi-check-circle-fill"></i><div><strong>Stay browsing.</strong> The sticky player keeps audio going while you explore past streams.</div></li>
          <li><i class="bi bi-check-circle-fill"></i><div><strong>Share a link.</strong> Send this page to someone who needs to hear the message today.</div></li>
        </ol>
      </div>
    </div>

    <div class="col-lg-5">
      <div class="glass-card p-3 p-md-4 mb-3">
        <h6 class="mb-3">Service rhythm</h6>
        <div class="d-flex flex-wrap gap-2 mb-3">
          <span class="stat-pill"><i class="bi bi-calendar-event"></i> Sundays</span>
          <span class="stat-pill"><i class="bi bi-clock"></i> 10:00 AM WAT</span>
          <span class="stat-pill"><i class="bi bi-mic"></i> Word + Worship</span>
        </div>
        <p class="text-muted small mb-3">Expect a faith-filled set, a clear word, and room to respond. If your connection drops, reopen the Live player and it will sync again.</p>
        <div class="d-flex flex-wrap gap-2">
          <a class="btn btn-outline-light btn-sm" href="https://layersoftruth.org/" target="_blank" rel="noopener"><i class="bi bi-geo-alt"></i> Plan a visit</a>
          <a class="btn btn-outline-light btn-sm" href="https://wa.me/2349030000000" target="_blank" rel="noopener"><i class="bi bi-chat-heart"></i> Prayer request</a>
        </div>
      </div>

      <div class="glass-card p-3 p-md-4">
        <h6 class="mb-3">Stay connected</h6>
        <div class="social-links">
          <a href="https://layersoftruth.org/" target="_blank" rel="noopener"><i class="bi bi-globe"></i> Website</a>
          <a href="https://www.youtube.com/@layersoftruth_ng" target="_blank" rel="noopener"><i class="bi bi-youtube"></i> YouTube</a>
          <a href="https://www.instagram.com/layersoftruth_ng/" target="_blank" rel="noopener"><i class="bi bi-instagram"></i> Instagram</a>
          <a href="https://www.facebook.com/layersoftruthng/" target="_blank" rel="noopener"><i class="bi bi-facebook"></i> Facebook</a>
          <a href="https://x.com/Layers_of_Truth" target="_blank" rel="noopener"><i class="bi bi-twitter-x"></i> X</a>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="container section-gap">
  <div class="d-flex justify-content-between align-items-center mb-3 flex-wrap gap-2">
    <div>
      <span class="eyebrow">Community</span>
      <h2 class="h5 m-0">Moments from worship</h2>
    </div>
    <button class="btn btn-outline-light btn-sm" type="button" data-share><i class="bi bi-share"></i> Share</button>
  </div>
  <div class="gallery-lt">
    <figure><img src="{% static 'assets/worship.png' %}" alt="Worship moment" loading="lazy"></figure>
    <figure><img src="{% static 'assets/congregation.png' %}" alt="Congregation worshipping" loading="lazy"></figure>
    <figure><img src="{% static 'assets/congregation2.jpeg' %}" alt="Service gathering" loading="lazy"></figure>
    <figure><img src="{% static 'assets/gatherings-flyer.png' %}" alt="Service times flyer" loading="lazy"></figure>
  </div>
</section>

<div class="mini-cta" aria-live="polite">
  <div class="mini-shell glass-card" id="miniShell">
    <div class="d-flex align-items-center gap-2">
      <img src="{% static 'assets/gatherings-flyer.png' %}" alt="">
      <div>
        <div class="fw-semibold small">Layers of Truth Live</div>
        <div class="text-muted small">Tap to open the live player</div>
      </div>
    </div>
    <div class="d-flex flex-wrap gap-2">
      <a class="btn btn-brand btn-sm" href="#playerStage"><i class="bi bi-broadcast-pin"></i> Listen now</a>
      <button class="btn btn-outline-light btn-sm" type="button" data-share><i class="bi bi-link-45deg"></i> Share</button>
    </div>
  </div>
</div>

<div class="lightbox" id="lightbox"><img alt=""></div>
{% endblock %}

{% block scripts %}
<script src="https://embed.radio.co/player/3c1bba1.js"></script>
<script>
(function(){
  const share = () => {
    const url = location.href;
    const text = 'Join the Layers of Truth live stream: ' + url;
    if (navigator.share) { navigator.share({ title: document.title, text, url }); }
    else { window.open('https://wa.me/?text=' + encodeURIComponent(text), '_blank', 'noopener'); }
  };
  document.querySelectorAll('[data-share]').forEach(btn => btn.addEventListener('click', share));

  // Lightbox for gallery
  const lb = document.getElementById('lightbox');
  const lbImg = lb?.querySelector('img');
  document.querySelectorAll('.gallery-lt img').forEach(img=>{
    img.addEventListener('click', ()=>{ if(lb && lbImg){ lbImg.src = img.src; lb.classList.add('open'); } });
  });
  lb?.addEventListener('click', ()=> lb.classList.remove('open'));

  // Sticky mini reveal
  const mini = document.getElementById('miniShell');
  if(mini){
    const onScroll = ()=>{
      const y = window.scrollY || document.documentElement.scrollTop;
      if(y > 320){ mini.classList.add('show'); }
      else { mini.classList.remove('show'); }
    };
    window.addEventListener('scroll', onScroll, {passive:true});
    onScroll();
  }
})();
</script>
{% endblock %}
